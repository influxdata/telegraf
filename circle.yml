machine:
  go:
    version: 1.8.1
  environment:
    CIRCLE_RELEASE_USER: "orangesys"
    CIRCLE_RELEASE_REPO: "telegraf-output-orangesys"
  services:
    - docker
    - memcached
    - redis
    - rabbitmq-server

dependencies:
  override:
    - docker info

checkout:
  post:
    - git submodule sync --recursive
    - git submodule update --recursive --init

test:
  override:
    - /bin/true

deployment:
  master:
    branch: master
    commands:
      - bash scripts/orangesys-telegraf.sh

  release:
    tag: /v[0-9]+(\.[0-9]+)*/
    commands:
      - bash scripts/github-release.sh
